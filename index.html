<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stardust Clicker - Space Exploration Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'space-dark': '#0a0a23',
                        'space-blue': '#1e3a8a',
                        'star-gold': '#fbbf24',
                        'nebula-purple': '#7c3aed',
                        'cosmic-pink': '#ec4899',
                        'cosmic-cyan': '#06b6d4',
                        'solar-orange': '#f97316',
                        'void-black': '#111827'
                    },
                    animation: {
                        'float': 'float 3s ease-in-out infinite',
                        'pulse-slow': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-gentle': 'bounce-gentle 1s ease-in-out',
                        'shine': 'shine 1.5s ease-in-out infinite',
                        'twinkle': 'twinkle 2s ease-in-out infinite',
                        'orbit': 'orbit 10s linear infinite',
                        'particle-float': 'particle-float 4s ease-in-out infinite'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' }
                        },
                        'bounce-gentle': {
                            '0%, 100%': { transform: 'scale(1)' },
                            '50%': { transform: 'scale(1.05)' }
                        },
                        shine: {
                            '0%, 100%': { opacity: '0.8' },
                            '50%': { opacity: '1' }
                        },
                        twinkle: {
                            '0%, 100%': { opacity: '0.3', transform: 'scale(0.8)' },
                            '50%': { opacity: '1', transform: 'scale(1.2)' }
                        },
                        orbit: {
                            '0%': { transform: 'rotate(0deg) translateX(100px) rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg) translateX(100px) rotate(-360deg)' }
                        },
                        'particle-float': {
                            '0%, 100%': { transform: 'translateY(0px) translateX(0px)', opacity: '0.7' },
                            '50%': { transform: 'translateY(-20px) translateX(10px)', opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .stars {
            background: radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                        radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                        radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                        radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
                        radial-gradient(2px 2px at 160px 30px, #ddd, transparent),
                        radial-gradient(1px 1px at 180px 10px, rgba(255,255,255,0.9), transparent);
            background-repeat: repeat;
            background-size: 200px 120px;
            animation: twinkle 3s ease-in-out infinite;
        }
        
        .nebula-bg {
            background: radial-gradient(ellipse at center, rgba(124, 58, 237, 0.3) 0%, transparent 70%),
                        radial-gradient(ellipse at 80% 20%, rgba(236, 72, 153, 0.2) 0%, transparent 50%),
                        radial-gradient(ellipse at 20% 80%, rgba(6, 182, 212, 0.2) 0%, transparent 60%);
        }
        
        .floating-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            background: radial-gradient(circle, #fbbf24, transparent);
            border-radius: 50%;
            animation: particle-float 4s ease-in-out infinite;
        }
        
        .click-effect {
            animation: bounce-gentle 0.3s ease-out;
        }
        
        .floating-text {
            animation: float-up 1s ease-out forwards;
        }
        
        @keyframes float-up {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) scale(1.2);
                opacity: 0;
            }
        }
        
        .modal-backdrop {
            backdrop-filter: blur(10px);
        }
        
        .upgrade-glow {
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.3);
        }
        
        .prestige-glow {
            box-shadow: 0 0 30px rgba(236, 72, 153, 0.5);
        }
    </style>
</head>
<body class="bg-gradient-to-b from-space-dark via-space-blue to-void-black min-h-screen text-white overflow-x-hidden">
    <!-- Starfield Background -->
    <div class="fixed inset-0 stars opacity-40"></div>
    <div class="fixed inset-0 nebula-bg"></div>
    
    <!-- Floating Particles -->
    <div class="floating-particles fixed inset-0" id="particles-container"></div>
    
    <!-- Wiki Modal -->
    <div id="wiki-modal" class="fixed inset-0 modal-backdrop bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="bg-gradient-to-br from-space-dark to-void-black border-2 border-star-gold rounded-xl p-6 max-w-4xl max-h-[90vh] overflow-y-auto mx-4 w-full">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold bg-gradient-to-r from-star-gold to-cosmic-pink bg-clip-text text-transparent">
                    📚 Stardust Clicker Wiki
                </h2>
                <button onclick="closeWiki()" class="text-gray-400 hover:text-white text-2xl">✕</button>
            </div>
            
            <div class="space-y-6 text-sm">
                <!-- Game Overview -->
                <section>
                    <h3 class="text-xl font-bold text-star-gold mb-3">🌟 Game Overview</h3>
                    <p class="text-gray-300 mb-4">Welcome to Stardust Clicker! Explore the cosmos by clicking stars to collect stardust, purchase upgrades to boost your power, and unlock the mysteries of the universe through prestige.</p>
                </section>
                
                <!-- Basic Mechanics -->
                <section>
                    <h3 class="text-xl font-bold text-nebula-purple mb-3">⚡ Basic Mechanics</h3>
                    <ul class="text-gray-300 space-y-2">
                        <li><strong>Clicking:</strong> Click the main star to generate stardust</li>
                        <li><strong>Click Power:</strong> Determines how much stardust you get per click</li>
                        <li><strong>Auto Production:</strong> Passive stardust generation from generators</li>
                        <li><strong>Upgrades:</strong> Improve your clicking power and production</li>
                    </ul>
                </section>
                
                <!-- Click Upgrades -->
                <section>
                    <h3 class="text-xl font-bold text-cosmic-pink mb-3">🔧 Click Upgrades</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-300">
                        <div>
                            <h4 class="font-bold text-star-gold">Basic Upgrades:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>Star Forge:</strong> Doubles click power (2x)</li>
                                <li>• <strong>Cosmic Enhancer:</strong> 5x click power boost</li>
                                <li>• <strong>Quantum Amplifier:</strong> 10x click power boost</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-star-gold">Advanced Upgrades:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>Stellar Reactor:</strong> 25x click power boost</li>
                                <li>• <strong>Nova Catalyst:</strong> 100x click power boost</li>
                                <li>• <strong>Black Hole Generator:</strong> 500x power</li>
                                <li>• <strong>Galaxy Engine:</strong> 2500x power</li>
                                <li>• <strong>Universe Forge:</strong> 10000x power</li>
                            </ul>
                        </div>
                    </div>
                </section>
                
                <!-- Auto Generators -->
                <section>
                    <h3 class="text-xl font-bold text-cosmic-cyan mb-3">🤖 Auto Generators</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-300">
                        <div>
                            <h4 class="font-bold text-star-gold">Basic Generators:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>Space Probe:</strong> 1 stardust/sec</li>
                                <li>• <strong>Mining Drone:</strong> 3 stardust/sec</li>
                                <li>• <strong>Orbital Satellite:</strong> 8 stardust/sec</li>
                                <li>• <strong>Space Station:</strong> 25 stardust/sec</li>
                                <li>• <strong>Fleet Carrier:</strong> 80 stardust/sec</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-star-gold">Advanced Generators:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>Mothership:</strong> 250 stardust/sec</li>
                                <li>• <strong>Galactic Network:</strong> 800 stardust/sec</li>
                                <li>• <strong>Dyson Sphere:</strong> 2500 stardust/sec</li>
                                <li>• <strong>Cosmic Entity:</strong> 8000 stardust/sec</li>
                                <li>• <strong>Reality Engine:</strong> 25000 stardust/sec</li>
                            </ul>
                        </div>
                    </div>
                </section>
                
                <!-- Prestige System -->
                <section>
                    <h3 class="text-xl font-bold text-cosmic-pink mb-3">💫 Prestige System</h3>
                    <p class="text-gray-300 mb-4">Reset your progress to gain permanent bonuses! Each prestige level requires specific stardust amounts and grants unique perks:</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-300">
                        <div>
                            <h4 class="font-bold text-star-gold">Prestige Levels 1-5:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>Level 1 (1M):</strong> 2x click power</li>
                                <li>• <strong>Level 2 (3M):</strong> 1.5x auto production</li>
                                <li>• <strong>Level 3 (10M):</strong> 3x click power</li>
                                <li>• <strong>Level 4 (25M):</strong> 2x auto production</li>
                                <li>• <strong>Level 5 (100M):</strong> 5x click power</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-star-gold">Prestige Levels 6-10:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>Level 6 (300M):</strong> 3x auto production</li>
                                <li>• <strong>Level 7 (1B):</strong> 10x click power</li>
                                <li>• <strong>Level 8 (3B):</strong> 5x auto production</li>
                                <li>• <strong>Level 9 (10B):</strong> 25x click power</li>
                                <li>• <strong>Level 10 (50B):</strong> 10x auto production</li>
                            </ul>
                        </div>
                    </div>
                </section>
                
                <!-- Achievements -->
                <section>
                    <h3 class="text-xl font-bold text-solar-orange mb-3">🏆 Achievements</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-300">
                        <div>
                            <h4 class="font-bold text-star-gold">Basic Achievements:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>First Contact:</strong> Click the star once</li>
                                <li>• <strong>Star Toucher:</strong> Click 100 times</li>
                                <li>• <strong>Cosmic Collector:</strong> Collect 1,000 stardust</li>
                                <li>• <strong>Technology Pioneer:</strong> Buy first upgrade</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-star-gold">Advanced Achievements:</h4>
                            <ul class="space-y-1 mt-2">
                                <li>• <strong>Automation Master:</strong> 100 stardust/sec</li>
                                <li>• <strong>Cosmic Millionaire:</strong> 1M stardust</li>
                                <li>• <strong>Click Legend:</strong> 10,000 clicks</li>
                                <li>• <strong>Prestige Master:</strong> Complete first prestige</li>
                            </ul>
                        </div>
                    </div>
                </section>
                
                <!-- Tips and Strategies -->
                <section>
                    <h3 class="text-xl font-bold text-cosmic-cyan mb-3">💡 Tips & Strategies</h3>
                    <ul class="text-gray-300 space-y-2">
                        <li><strong>Early Game:</strong> Focus on click upgrades first, then buy cheap auto generators</li>
                        <li><strong>Mid Game:</strong> Balance between auto generators and click upgrades based on your playstyle</li>
                        <li><strong>Late Game:</strong> Prepare for prestige by maximizing stardust before reset</li>
                        <li><strong>Prestige Strategy:</strong> Don't prestige too early - maximize your current run first</li>
                        <li><strong>Idle Strategy:</strong> Invest heavily in auto generators for passive income</li>
                        <li><strong>Active Strategy:</strong> Focus on click upgrades and actively click for maximum efficiency</li>
                    </ul>
                </section>
            </div>
        </div>
    </div>
    
    <!-- Main Game Container -->
    <div class="relative z-10 container mx-auto px-4 py-6 max-w-7xl">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-6xl font-bold bg-gradient-to-r from-star-gold via-cosmic-pink to-cosmic-cyan bg-clip-text text-transparent mb-2 animate-shine">
                🌟 Stardust Clicker
            </h1>
            <p class="text-lg text-gray-300 mb-4">Explore the cosmos, one click at a time!</p>
            <button onclick="openWiki()" 
                    class="bg-gradient-to-r from-nebula-purple to-cosmic-pink hover:from-cosmic-pink hover:to-nebula-purple text-white font-bold py-2 px-6 rounded-full transition-all duration-300 upgrade-glow">
                📚 Open Wiki
            </button>
        </header>
        
        <!-- Game Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-4 border border-star-gold border-opacity-30 upgrade-glow">
                <div class="text-center">
                    <div class="text-xl md:text-2xl font-bold text-star-gold" id="stardust-count">0</div>
                    <div class="text-xs md:text-sm text-gray-300">✨ Stardust</div>
                </div>
            </div>
            <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-4 border border-nebula-purple border-opacity-30">
                <div class="text-center">
                    <div class="text-xl md:text-2xl font-bold text-nebula-purple" id="stardust-per-second">0</div>
                    <div class="text-xs md:text-sm text-gray-300">🚀 Per Second</div>
                </div>
            </div>
            <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-4 border border-cosmic-pink border-opacity-30">
                <div class="text-center">
                    <div class="text-xl md:text-2xl font-bold text-cosmic-pink" id="total-clicks">0</div>
                    <div class="text-xs md:text-sm text-gray-300">🎯 Total Clicks</div>
                </div>
            </div>
            <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-4 border border-cosmic-cyan border-opacity-30">
                <div class="text-center">
                    <div class="text-xl md:text-2xl font-bold text-cosmic-cyan" id="prestige-level">0</div>
                    <div class="text-xs md:text-sm text-gray-300">💫 Prestige</div>
                </div>
            </div>
        </div>
        
        <!-- Main Game Area -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Clicking Area -->
            <div class="lg:col-span-2">
                <div class="text-center mb-6">
                    <div class="relative inline-block">
                        <!-- Orbital Elements -->
                        <div class="absolute inset-0 animate-orbit opacity-50">
                            <div class="w-2 h-2 bg-star-gold rounded-full"></div>
                        </div>
                        <div class="absolute inset-0 animate-orbit opacity-30" style="animation-delay: -5s; animation-duration: 15s;">
                            <div class="w-1 h-1 bg-cosmic-pink rounded-full"></div>
                        </div>
                        
                        <button id="main-clicker" 
                                class="w-48 h-48 md:w-64 md:h-64 bg-gradient-to-br from-star-gold via-cosmic-pink to-cosmic-cyan rounded-full border-4 border-white border-opacity-20 shadow-2xl hover:shadow-star-gold hover:shadow-2xl transition-all duration-200 transform hover:scale-105 animate-float prestige-glow">
                            <div class="text-6xl md:text-8xl animate-shine">🌟</div>
                        </button>
                        <div id="click-effects" class="absolute inset-0 pointer-events-none"></div>
                    </div>
                    <p class="mt-4 text-lg text-gray-300">Click the star to collect stardust!</p>
                    <p class="text-sm text-star-gold">+<span id="click-power">1</span> per click</p>
                </div>
                
                <!-- Achievements -->
                <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-10 upgrade-glow">
                    <h3 class="text-xl font-bold mb-4 text-center bg-gradient-to-r from-solar-orange to-star-gold bg-clip-text text-transparent">🏆 Achievements</h3>
                    <div id="achievements-list" class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <!-- Achievements will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- Upgrades Panel -->
            <div class="space-y-6">
                <!-- Click Upgrades -->
                <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-10 upgrade-glow">
                    <h3 class="text-xl font-bold mb-4 text-center bg-gradient-to-r from-star-gold to-cosmic-pink bg-clip-text text-transparent">⚡ Click Upgrades</h3>
                    <div id="click-upgrades" class="space-y-3 max-h-60 overflow-y-auto">
                        <!-- Click upgrades will be populated here -->
                    </div>
                </div>
                
                <!-- Auto Generators -->
                <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-10 upgrade-glow">
                    <h3 class="text-xl font-bold mb-4 text-center bg-gradient-to-r from-cosmic-cyan to-nebula-purple bg-clip-text text-transparent">🤖 Auto Generators</h3>
                    <div id="auto-generators" class="space-y-3 max-h-60 overflow-y-auto">
                        <!-- Auto generators will be populated here -->
                    </div>
                </div>
                
                <!-- Prestige -->
                <div class="bg-black bg-opacity-50 backdrop-blur-sm rounded-xl p-6 border border-white border-opacity-10 prestige-glow">
                    <h3 class="text-xl font-bold mb-4 text-center bg-gradient-to-r from-cosmic-pink to-nebula-purple bg-clip-text text-transparent">💫 Prestige</h3>
                    <div class="text-sm text-gray-300 mb-4">
                        <p>Next Level: <span id="next-prestige-req">1M</span> stardust</p>
                        <p>Perk: <span id="next-prestige-perk">2x click power</span></p>
                    </div>
                    <button id="prestige-btn" 
                            class="w-full bg-gradient-to-r from-cosmic-pink to-nebula-purple hover:from-nebula-purple hover:to-cosmic-pink text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed">
                        Prestige to Level <span id="next-prestige-level">1</span>
                    </button>
                    <div class="text-xs text-gray-400 mt-2 space-y-1">
                        <p>Current Level: <span id="current-prestige">0</span></p>
                        <p id="prestige-bonuses">No bonuses yet</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            stardust: 0,
            stardustPerSecond: 0,
            totalClicks: 0,
            baseClickPower: 1,
            clickMultiplierTotal: 1,
            prestigeLevel: 0,
            clickUpgrades: {
                starforge: { level: 0, baseCost: 15, multiplier: 2 },
                cosmicEnhancer: { level: 0, baseCost: 100, multiplier: 5 },
                quantumAmplifier: { level: 0, baseCost: 700, multiplier: 10 },
                stellarReactor: { level: 0, baseCost: 4900, multiplier: 25 },
                novaCatalyst: { level: 0, baseCost: 34300, multiplier: 100 },
                blackHoleGenerator: { level: 0, baseCost: 240100, multiplier: 500 },
                galaxyEngine: { level: 0, baseCost: 1680700, multiplier: 2500 },
                universeForge: { level: 0, baseCost: 11764900, multiplier: 10000 }
            },
            autoGenerators: {
                probe: { count: 0, baseCost: 10, production: 1 },
                miningDrone: { count: 0, baseCost: 25, production: 3 },
                satellite: { count: 0, baseCost: 75, production: 8 },
                station: { count: 0, baseCost: 250, production: 25 },
                fleetCarrier: { count: 0, baseCost: 800, production: 80 },
                mothership: { count: 0, baseCost: 2500, production: 250 },
                galacticNetwork: { count: 0, baseCost: 8000, production: 800 },
                dysonSphere: { count: 0, baseCost: 25000, production: 2500 },
                cosmicEntity: { count: 0, baseCost: 80000, production: 8000 },
                realityEngine: { count: 0, baseCost: 250000, production: 25000 }
            },
            achievements: new Set()
        };

        // Cached upgrade buttons to avoid rebuilding
        let lastStardust = -1;
        let upgradeButtonsCache = null;

        // Prestige levels and requirements
        const prestigeLevels = [
            { level: 1, requirement: 1000000, perk: "2x click power", clickMultiplier: 2, autoMultiplier: 1 },
            { level: 2, requirement: 3000000, perk: "1.5x auto production", clickMultiplier: 1, autoMultiplier: 1.5 },
            { level: 3, requirement: 10000000, perk: "3x click power", clickMultiplier: 3, autoMultiplier: 1 },
            { level: 4, requirement: 25000000, perk: "2x auto production", clickMultiplier: 1, autoMultiplier: 2 },
            { level: 5, requirement: 100000000, perk: "5x click power", clickMultiplier: 5, autoMultiplier: 1 },
            { level: 6, requirement: 300000000, perk: "3x auto production", clickMultiplier: 1, autoMultiplier: 3 },
            { level: 7, requirement: 1000000000, perk: "10x click power", clickMultiplier: 10, autoMultiplier: 1 },
            { level: 8, requirement: 3000000000, perk: "5x auto production", clickMultiplier: 1, autoMultiplier: 5 },
            { level: 9, requirement: 10000000000, perk: "25x click power", clickMultiplier: 25, autoMultiplier: 1 },
            { level: 10, requirement: 50000000000, perk: "10x auto production", clickMultiplier: 1, autoMultiplier: 10 }
        ];

        // Achievement definitions
        const achievements = [
            { id: 'first-click', name: 'First Contact', desc: 'Click the star for the first time', icon: '👆', req: () => gameState.totalClicks >= 1 },
            { id: 'hundred-clicks', name: 'Star Toucher', desc: 'Click 100 times', icon: '✋', req: () => gameState.totalClicks >= 100 },
            { id: 'thousand-clicks', name: 'Click Legend', desc: 'Click 10,000 times', icon: '🖱️', req: () => gameState.totalClicks >= 10000 },
            { id: 'thousand-stardust', name: 'Cosmic Collector', desc: 'Collect 1,000 stardust', icon: '💎', req: () => gameState.stardust >= 1000 },
            { id: 'million-stardust', name: 'Cosmic Millionaire', desc: 'Collect 1,000,000 stardust', icon: '🎩', req: () => gameState.stardust >= 1000000 },
            { id: 'first-upgrade', name: 'Technology Pioneer', desc: 'Buy your first upgrade', icon: '🔧', req: () => getTotalUpgrades() > 0 },
            { id: 'auto-pilot', name: 'Automation Master', desc: 'Generate 100 stardust per second', icon: '🤖', req: () => gameState.stardustPerSecond >= 100 },
            { id: 'first-prestige', name: 'Prestige Master', desc: 'Complete your first prestige', icon: '💫', req: () => gameState.prestigeLevel >= 1 }
        ];

        // Initialize dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Create floating particles
        function createParticles() {
            const container = document.getElementById('particles-container');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.width = (Math.random() * 3 + 1) + 'px';
                particle.style.height = particle.style.width;
                particle.style.animationDelay = Math.random() * 4 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 2) + 's';
                container.appendChild(particle);
            }
        }

        // Wiki functions
        function openWiki() {
            document.getElementById('wiki-modal').classList.remove('hidden');
        }

        function closeWiki() {
            document.getElementById('wiki-modal').classList.add('hidden');
        }

        // Utility functions
        function formatNumber(num) {
            if (num < 1000) return Math.floor(num).toString();
            if (num < 1000000) return (num / 1000).toFixed(1) + 'K';
            if (num < 1000000000) return (num / 1000000).toFixed(1) + 'M';
            if (num < 1000000000000) return (num / 1000000000).toFixed(1) + 'B';
            return (num / 1000000000000).toFixed(1) + 'T';
        }

        function getTotalUpgrades() {
            let total = 0;
            Object.values(gameState.clickUpgrades).forEach(upgrade => total += upgrade.level);
            Object.values(gameState.autoGenerators).forEach(gen => total += gen.count);
            return total;
        }

        function getPrestigeBonuses() {
            let clickMultiplier = 1;
            let autoMultiplier = 1;
            
            for (let i = 0; i < gameState.prestigeLevel; i++) {
                if (prestigeLevels[i]) {
                    clickMultiplier *= prestigeLevels[i].clickMultiplier;
                    autoMultiplier *= prestigeLevels[i].autoMultiplier;
                }
            }
            
            return { clickMultiplier, autoMultiplier };
        }

        function createFloatingText(x, y, text, color = '#fbbf24') {
            const element = document.createElement('div');
            element.textContent = text;
            element.className = 'absolute pointer-events-none text-lg font-bold floating-text';
            element.style.left = x + 'px';
            element.style.top = y + 'px';
            element.style.color = color;
            element.style.zIndex = '1000';
            
            document.getElementById('click-effects').appendChild(element);
            
            setTimeout(() => element.remove(), 1000);
        }

        // Calculate total click power
        function calculateClickPower() {
            let totalMultiplier = 1;
            Object.values(gameState.clickUpgrades).forEach(upgrade => {
                totalMultiplier += upgrade.level * (upgrade.multiplier - 1);
            });
            
            const bonuses = getPrestigeBonuses();
            return gameState.baseClickPower * totalMultiplier * bonuses.clickMultiplier;
        }

        // Main click handler
        document.getElementById('main-clicker').addEventListener('click', (e) => {
            const clickValue = calculateClickPower();
            gameState.stardust += clickValue;
            gameState.totalClicks++;
            
            // Visual feedback
            const button = e.currentTarget;
            button.classList.add('click-effect');
            setTimeout(() => button.classList.remove('click-effect'), 300);
            
            // Floating text
            const rect = button.getBoundingClientRect();
            const x = Math.random() * 100 - 50;
            const y = Math.random() * 100 - 50;
            createFloatingText(
                rect.left + rect.width/2 + x,
                rect.top + rect.height/2 + y,
                `+${formatNumber(clickValue)}`
            );
            
            updateDisplay();
            checkAchievements();
        });

        // Update display - optimized to only update what's necessary
        function updateDisplay() {
            document.getElementById('stardust-count').textContent = formatNumber(gameState.stardust);
            document.getElementById('stardust-per-second').textContent = formatNumber(gameState.stardustPerSecond);
            document.getElementById('total-clicks').textContent = formatNumber(gameState.totalClicks);
            document.getElementById('prestige-level').textContent = gameState.prestigeLevel;
            
            document.getElementById('click-power').textContent = formatNumber(calculateClickPower());
            
            // Only update upgrades if stardust has changed significantly or upgrades were bought
            if (Math.abs(gameState.stardust - lastStardust) > gameState.stardust * 0.01 || lastStardust === -1) {
                updateUpgradeButtons();
                lastStardust = gameState.stardust;
            }
            
            updatePrestigeDisplay();
        }

        // Create upgrade buttons - optimized
        function createUpgradeButton(type, key, data) {
            const cost = type === 'click' ? 
                data.baseCost * Math.pow(1.5, data.level) :
                data.baseCost * Math.pow(1.15, data.count);
            
            const canAfford = gameState.stardust >= cost;
            
            const names = {
                click: {
                    starforge: 'Star Forge',
                    cosmicEnhancer: 'Cosmic Enhancer', 
                    quantumAmplifier: 'Quantum Amplifier',
                    stellarReactor: 'Stellar Reactor',
                    novaCatalyst: 'Nova Catalyst',
                    blackHoleGenerator: 'Black Hole Generator',
                    galaxyEngine: 'Galaxy Engine',
                    universeForge: 'Universe Forge'
                },
                auto: {
                    probe: 'Space Probe',
                    miningDrone: 'Mining Drone',
                    satellite: 'Orbital Satellite',
                    station: 'Space Station',
                    fleetCarrier: 'Fleet Carrier',
                    mothership: 'Mothership',
                    galacticNetwork: 'Galactic Network',
                    dysonSphere: 'Dyson Sphere',
                    cosmicEntity: 'Cosmic Entity',
                    realityEngine: 'Reality Engine'
                }
            };
            
            const descriptions = {
                click: {
                    starforge: `${data.multiplier}x click power (Level ${data.level})`,
                    cosmicEnhancer: `${data.multiplier}x click power (Level ${data.level})`,
                    quantumAmplifier: `${data.multiplier}x click power (Level ${data.level})`,
                    stellarReactor: `${data.multiplier}x click power (Level ${data.level})`,
                    novaCatalyst: `${data.multiplier}x click power (Level ${data.level})`,
                    blackHoleGenerator: `${data.multiplier}x click power (Level ${data.level})`,
                    galaxyEngine: `${data.multiplier}x click power (Level ${data.level})`,
                    universeForge: `${data.multiplier}x click power (Level ${data.level})`
                },
                auto: {
                    probe: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    miningDrone: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    satellite: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    station: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    fleetCarrier: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    mothership: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    galacticNetwork: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    dysonSphere: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    cosmicEntity: `${data.count} producing ${formatNumber(data.production)}/s each`,
                    realityEngine: `${data.count} producing ${formatNumber(data.production)}/s each`
                }
            };
            
            const button = document.createElement('button');
            button.className = `w-full p-3 rounded-lg border transition-all duration-200 text-left ${
                canAfford 
                    ? 'bg-gradient-to-r from-space-blue to-nebula-purple border-star-gold border-opacity-50 hover:border-opacity-100 hover:shadow-lg upgrade-glow' 
                    : 'bg-gray-800 border-gray-600 opacity-50 cursor-not-allowed'
            }`;
            
            button.innerHTML = `
                <div class="flex justify-between items-center">
                    <div>
                        <div class="font-bold text-sm">${names[type][key]}</div>
                        <div class="text-xs text-gray-300">${descriptions[type][key]}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-star-gold font-bold text-sm">${formatNumber(cost)}</div>
                        <div class="text-xs text-gray-400">✨</div>
                    </div>
                </div>
            `;
            
            if (canAfford) {
                button.addEventListener('click', () => {
                    if (type === 'click') {
                        buyClickUpgrade(key);
                    } else {
                        buyAutoUpgrade(key);
                    }
                });
            } else {
                button.disabled = true;
            }
            
            return button;
        }

        // Update upgrade buttons - optimized
        function updateUpgradeButtons() {
            // Click upgrades
            const clickContainer = document.getElementById('click-upgrades');
            clickContainer.innerHTML = '';
            Object.entries(gameState.clickUpgrades).forEach(([key, data]) => {
                clickContainer.appendChild(createUpgradeButton('click', key, data));
            });
            
            // Auto generators
            const autoContainer = document.getElementById('auto-generators');
            autoContainer.innerHTML = '';
            Object.entries(gameState.autoGenerators).forEach(([key, data]) => {
                autoContainer.appendChild(createUpgradeButton('auto', key, data));
            });
        }

        // Buy upgrades - optimized with immediate feedback
        function buyClickUpgrade(key) {
            const upgrade = gameState.clickUpgrades[key];
            const cost = upgrade.baseCost * Math.pow(1.5, upgrade.level);
            
            if (gameState.stardust >= cost) {
                gameState.stardust -= cost;
                upgrade.level++;
                updateDisplay();
                checkAchievements();
            }
        }

        function buyAutoUpgrade(key) {
            const generator = gameState.autoGenerators[key];
            const cost = generator.baseCost * Math.pow(1.15, generator.count);
            
            if (gameState.stardust >= cost) {
                gameState.stardust -= cost;
                generator.count++;
                updateAutoProduction();
                updateDisplay();
                checkAchievements();
            }
        }

        // Update auto production
        function updateAutoProduction() {
            const bonuses = getPrestigeBonuses();
            gameState.stardustPerSecond = 0;
            Object.values(gameState.autoGenerators).forEach(gen => {
                gameState.stardustPerSecond += gen.count * gen.production;
            });
            gameState.stardustPerSecond *= bonuses.autoMultiplier;
        }

        // Prestige system
        function updatePrestigeDisplay() {
            const nextLevel = gameState.prestigeLevel + 1;
            const nextPrestige = prestigeLevels[nextLevel - 1];
            
            if (nextPrestige) {
                document.getElementById('next-prestige-level').textContent = nextLevel;
                document.getElementById('next-prestige-req').textContent = formatNumber(nextPrestige.requirement);
                document.getElementById('next-prestige-perk').textContent = nextPrestige.perk;
                
                const canPrestige = gameState.stardust >= nextPrestige.requirement;
                const prestigeBtn = document.getElementById('prestige-btn');
                prestigeBtn.disabled = !canPrestige;
                
                if (canPrestige) {
                    prestigeBtn.onclick = () => prestige(nextLevel);
                }
            } else {
                document.getElementById('next-prestige-level').textContent = 'MAX';
                document.getElementById('next-prestige-req').textContent = 'MAX LEVEL';
                document.getElementById('next-prestige-perk').textContent = 'All unlocked!';
                document.getElementById('prestige-btn').disabled = true;
            }
            
            document.getElementById('current-prestige').textContent = gameState.prestigeLevel;
            
            // Show active bonuses
            const bonuses = getPrestigeBonuses();
            let bonusText = 'No bonuses yet';
            if (gameState.prestigeLevel > 0) {
                bonusText = `${formatNumber(bonuses.clickMultiplier)}x click, ${formatNumber(bonuses.autoMultiplier)}x auto`;
            }
            document.getElementById('prestige-bonuses').textContent = bonusText;
        }

        function prestige(level) {
            showConfirmDialog(`Prestige to level ${level}? This will reset your progress but grant permanent bonuses.`, () => {
                gameState.prestigeLevel = level;
                gameState.stardust = 0;
                gameState.stardustPerSecond = 0;
                gameState.totalClicks = 0;
                gameState.clickPower = 1;
                
                // Reset upgrades
                Object.values(gameState.clickUpgrades).forEach(upgrade => upgrade.level = 0);
                Object.values(gameState.autoGenerators).forEach(gen => gen.count = 0);
                
                // Reset cache
                lastStardust = -1;
                
                updateAutoProduction();
                updateDisplay();
                checkAchievements();
            });
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 modal-backdrop bg-black bg-opacity-70 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-gradient-to-br from-space-dark to-void-black border-2 border-star-gold p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end space-x-3">
                        <button class="px-4 py-2 text-gray-400 hover:bg-gray-700 rounded" onclick="this.closest('.fixed').remove()">Cancel</button>
                        <button class="px-4 py-2 bg-cosmic-pink text-white hover:bg-opacity-80 rounded" onclick="this.closest('.fixed').remove(); onConfirm()">Confirm</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Achievements
        function checkAchievements() {
            achievements.forEach(achievement => {
                if (!gameState.achievements.has(achievement.id) && achievement.req()) {
                    gameState.achievements.add(achievement.id);
                    showAchievement(achievement);
                }
            });
            updateAchievementsDisplay();
        }

        function showAchievement(achievement) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-gradient-to-r from-star-gold to-cosmic-pink text-black p-4 rounded-lg shadow-lg z-50 animate-bounce-gentle upgrade-glow';
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="text-2xl">${achievement.icon}</div>
                    <div>
                        <div class="font-bold">Achievement Unlocked!</div>
                        <div class="text-sm">${achievement.name}</div>
                    </div>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 3000);
        }

        function updateAchievementsDisplay() {
            const achievementsHTML = achievements.map(achievement => {
                const unlocked = gameState.achievements.has(achievement.id);
                return `
                    <div class="p-3 rounded-lg border ${
                        unlocked 
                            ? 'bg-gradient-to-r from-star-gold to-cosmic-pink text-black upgrade-glow' 
                            : 'bg-gray-800 border-gray-600 text-gray-400'
                    }">
                        <div class="flex items-center space-x-2">
                            <div class="text-xl">${achievement.icon}</div>
                            <div>
                                <div class="font-bold text-xs">${achievement.name}</div>
                                <div class="text-xs opacity-80">${achievement.desc}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('achievements-list').innerHTML = achievementsHTML;
        }

        // Game loop
        function gameLoop() {
            if (gameState.stardustPerSecond > 0) {
                gameState.stardust += gameState.stardustPerSecond / 10; // 10 FPS
                updateDisplay();
            }
            checkAchievements();
        }

        // Initialize game
        function initGame() {
            createParticles();
            updateAutoProduction();
            updateDisplay();
            updateAchievementsDisplay();
            setInterval(gameLoop, 100); // 10 FPS
        }

        // Start the game
        initGame();
    </script>
</body>
</html>
